<!-- START OF FILE -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Mentees</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css" />
  <style>
    select[multiple] {
      width: 100%;
      height: auto;
      min-height: 100px;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #d1d5db;
      background-color: #fff;
      font-family: 'Inter', sans-serif;
    }
  </style>
</head>
<body>

<header>
  <div class="logo">LinkUp</div>
  <nav>
    <span id="userGreeting" class="user-greeting hidden">Hi, <strong id="userName">User</strong></span>
    <a href="index.html">Home</a>
    <a href="profile.html">Profile</a>
    <a href="mentorship.html" class="active">Mentorship</a>
    <a href="discover.html">Discover</a>
    <a href="community.html">Community</a>
    <button class="btn btn-secondary hidden" id="logoutBtn">Log Out</button>
  </nav>
</header>

<div class="role-toggle" style="display:flex;justify-content:center;gap:1rem;margin:2rem 0;">
  <button id="mentorViewBtn" class="toggle-btn active">As a Mentor</button>
  <button id="menteeViewBtn" class="toggle-btn">As a Mentee</button>
</div>

<main class="profile-section">
  <div id="mentorView" class="role-section">
    <!-- Mentor sections omitted for brevity -->
    <div class="scroll-container active"></div>
    <div class="scroll-container pending"></div>
  </div>

  <div id="menteeView" class="role-section hidden">
    <!-- Mentee sections omitted for brevity -->
    <div class="scroll-container mentee-active"></div>
    <div class="scroll-container mentee-pending"></div>
  </div>
</main>

<!-- Mentor Application Modal -->
<div id="mentorApplicationModal" class="modal hidden">
  <div class="modal-content">
    <span class="close" id="closeMentorModal">&times;</span>
    <h2>Find a Mentor</h2>
    <form id="mentorApplicationForm">
      <label for="learningOutcome"><strong>Learning Outcome</strong></label>
      <textarea id="learningOutcome" placeholder="What do you hope to learn?" required></textarea>

      <label for="appSkills"><strong>Skills</strong></label>
      <select id="appSkills" name="skills" multiple required>
        <option value="Leadership">Leadership</option>
        <option value="Strategic Planning">Strategic Planning</option>
        <option value="Team Management">Team Management</option>
        <option value="Communication">Communication</option>
      </select>

      <label for="appLearningStyles"><strong>Learning Styles</strong></label>
      <select id="appLearningStyles" name="learning_style" multiple required>
        <option value="Directed">Directed</option>
        <option value="Co-directed">Co-directed</option>
        <option value="Consulting">Consulting</option>
        <option value="Self-directed">Self-directed</option>
      </select>

      <label for="appCommModes"><strong>Communication Modes</strong></label>
      <select id="appCommModes" name="comm_mode" multiple required>
        <option value="Virtual">Virtual</option>
        <option value="In-Person">In-Person</option>
        <option value="Chat/Messaging">Chat/Messaging</option>
      </select>

      <button type="submit" class="btn btn-primary full-width" style="margin-top: 1rem;">Submit Application</button>
    </form>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script src="supabaseConfig.js"></script>

<script>
const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

document.addEventListener('DOMContentLoaded', async () => {
  // ... existing mentor/mentee logic omitted for brevity ...
});

// Show modal
function openMentorFinder() {
  document.getElementById('mentorApplicationModal').classList.remove('hidden');
}

// Close modal
document.getElementById('closeMentorModal').addEventListener('click', () => {
  document.getElementById('mentorApplicationModal').classList.add('hidden');
});

// Submit mentor application form
document.getElementById('mentorApplicationForm').addEventListener('submit', async function (e) {
  e.preventDefault();

  const learningOutcome = document.getElementById('learningOutcome').value;
  const skills = Array.from(document.getElementById('appSkills').selectedOptions).map(opt => opt.value);
  const learningStyles = Array.from(document.getElementById('appLearningStyles').selectedOptions).map(opt => opt.value);
  const commModes = Array.from(document.getElementById('appCommModes').selectedOptions).map(opt => opt.value);

  const { data: sessionData, error: sessionError } = await supabase.auth.getSession();
  const user = sessionData?.session?.user;

  if (!user) {
    alert("Please sign in to submit an application.");
    return;
  }

  const { error } = await supabase.from('mentor_applications').insert([{
    user_id: user.id,
    learning_outcome: learningOutcome,
    skills: skills,
    learning_style: learningStyles,
    comm_mode: commModes
  }]);

  if (error) {
    console.error("Insert failed:", error);
    alert("Submission failed: " + error.message);
  } else {
    alert("Application submitted successfully!");
    document.getElementById('mentorApplicationModal').classList.add('hidden');
    document.getElementById('mentorApplicationForm').reset();
  }
});
</script>
</body>
</html>
<!-- END OF FILE -->
